<?xml version="1.0"?>
<robot xmlns:xacro="http://ros.org/wiki/xacro">
    <!--tether model-->
    <xacro:macro name="tether">
        <!--tether params--><!--virtual link params--><!--actuated joint dynamics--><!--passive joint dynamics--><!-- main-->
        
            <link name="tether_0">
            <visual>
                <origin rpy="0 0 0" xyz="0 0 10.0"/>
                <geometry>
                    <cylinder length="20.0" radius="0.005"/>
                </geometry>
            </visual>
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>
        <gazebo reference="tether_0">
            <material>Gazebo/Black</material>
        </gazebo>
            <link name="virtual_link_uav2tether_1_0">
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>

        <link name="virtual_link_uav2tether_2_0">
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>
            <link name="virtual_link_ugv2tether_1_0">
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>

        <link name="virtual_link_ugv2tether_2_0">
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>

        <link name="virtual_link_ugv2tether_3_0">
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>
            <link name="rod_0">
            <visual>
                <origin rpy="0 0 0" xyz="0 0 0.1"/>
                <geometry>
                    <cylinder length="0.21" radius="0.01"/>
                </geometry>
            </visual>
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>
        <gazebo reference="rod_0">
            <material>Gazebo/Orange</material>
        </gazebo>
        <!--uav => tether joint-->
        <joint name="uav2rod_joint_0" type="fixed">
            <parent link="${namespace}/base_link"/>
            <child link="rod_0"/>
            
                <origin rpy="0 ${pi/2} 0" xyz="0 0 0"/>
            
        </joint>

        <joint name="rod2tether_joint_roll_0" type="continuous">
            <origin rpy="0 0 0" xyz="0 0 0.21"/>
            <parent link="rod_0"/>
            <child link="virtual_link_uav2tether_1_0"/>
            <axis xyz="1 0 0" />
            <dynamics damping="0.01" friction="0.0"/>
        </joint>

        <joint name="rod2tether_joint_pitch_0" type="continuous">
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <parent link="virtual_link_uav2tether_1_0"/>
            <child link="virtual_link_uav2tether_2_0"/>
            <axis xyz="0 1 0" />
            <dynamics damping="0.01" friction="0.0"/>
        </joint>

        <joint name="rod2tether_joint_yaw_0" type="continuous">
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <parent link="virtual_link_uav2tether_2_0"/>
            <child link="tether_0"/>
            <axis xyz="0 0 1" />
            <dynamics damping="0.01" friction="0.0"/>
        </joint>
            <joint name="ugv2tether_joint_prismatic_0" type="prismatic">
            <origin rpy="0 0 0" xyz="0 0 5"/>
            <parent link="tether_0"/>
            <child link="virtual_link_ugv2tether_1_0"/>
            <axis xyz="0 0 -1" />
            <dynamics damping="0.01" friction="0.0"/>
            <limit effort="10000" lower="-5.0" upper="10.0" velocity="10.0"/>
        </joint>

        <joint name="ugv2tether_joint_roll_0" type="continuous">
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <parent link="virtual_link_ugv2tether_1_0"/>
            <child link="virtual_link_ugv2tether_2_0"/>
            <axis xyz="1 0 0" />
            <dynamics damping="0.01" friction="0.0"/>
        </joint>

        <joint name="ugv2tether_joint_pitch_0" type="continuous">
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <parent link="virtual_link_ugv2tether_2_0"/>
            <child link="virtual_link_ugv2tether_3_0"/>
            <axis xyz="0 1 0" />
            <dynamics damping="0.01" friction="0.0"/>
        </joint>

        <joint name="ugv2tether_joint_yaw_0" type="continuous">
            
                <origin rpy="0 ${-pi/2} 0" xyz="0 0 0"/>
            
            <axis xyz="0 0 1" />
            <parent link="virtual_link_ugv2tether_3_0"/>
            <child link="mp_500_0/tether_end"/>
            <dynamics damping="0.01" friction="0.0"/>
        </joint>
        
            <link name="tether_1">
            <visual>
                <origin rpy="0 0 0" xyz="0 0 10.0"/>
                <geometry>
                    <cylinder length="20.0" radius="0.005"/>
                </geometry>
            </visual>
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>
        <gazebo reference="tether_1">
            <material>Gazebo/Black</material>
        </gazebo>
            <link name="virtual_link_uav2tether_1_1">
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>

        <link name="virtual_link_uav2tether_2_1">
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>
            <link name="virtual_link_ugv2tether_1_1">
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>

        <link name="virtual_link_ugv2tether_2_1">
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>

        <link name="virtual_link_ugv2tether_3_1">
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>
            <link name="rod_1">
            <visual>
                <origin rpy="0 0 0" xyz="0 0 0.1"/>
                <geometry>
                    <cylinder length="0.21" radius="0.01"/>
                </geometry>
            </visual>
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>
        <gazebo reference="rod_1">
            <material>Gazebo/Orange</material>
        </gazebo>
        <!--uav => tether joint-->
        <joint name="uav2rod_joint_1" type="fixed">
            <parent link="${namespace}/base_link"/>
            <child link="rod_1"/>
            
                <origin rpy="${pi/2} 0 0" xyz="0 0 0"/>
            
        </joint>

        <joint name="rod2tether_joint_roll_1" type="continuous">
            <origin rpy="0 0 0" xyz="0 0 0.21"/>
            <parent link="rod_1"/>
            <child link="virtual_link_uav2tether_1_1"/>
            <axis xyz="1 0 0" />
            <dynamics damping="0.01" friction="0.0"/>
        </joint>

        <joint name="rod2tether_joint_pitch_1" type="continuous">
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <parent link="virtual_link_uav2tether_1_1"/>
            <child link="virtual_link_uav2tether_2_1"/>
            <axis xyz="0 1 0" />
            <dynamics damping="0.01" friction="0.0"/>
        </joint>

        <joint name="rod2tether_joint_yaw_1" type="continuous">
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <parent link="virtual_link_uav2tether_2_1"/>
            <child link="tether_1"/>
            <axis xyz="0 0 1" />
            <dynamics damping="0.01" friction="0.0"/>
        </joint>
            <joint name="ugv2tether_joint_prismatic_1" type="prismatic">
            <origin rpy="0 0 0" xyz="0 0 5"/>
            <parent link="tether_1"/>
            <child link="virtual_link_ugv2tether_1_1"/>
            <axis xyz="0 0 -1" />
            <dynamics damping="0.01" friction="0.0"/>
            <limit effort="10000" lower="-5.0" upper="10.0" velocity="10.0"/>
        </joint>

        <joint name="ugv2tether_joint_roll_1" type="continuous">
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <parent link="virtual_link_ugv2tether_1_1"/>
            <child link="virtual_link_ugv2tether_2_1"/>
            <axis xyz="1 0 0" />
            <dynamics damping="0.01" friction="0.0"/>
        </joint>

        <joint name="ugv2tether_joint_pitch_1" type="continuous">
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <parent link="virtual_link_ugv2tether_2_1"/>
            <child link="virtual_link_ugv2tether_3_1"/>
            <axis xyz="0 1 0" />
            <dynamics damping="0.01" friction="0.0"/>
        </joint>

        <joint name="ugv2tether_joint_yaw_1" type="continuous">
            
                <origin rpy="${-pi/2} 0 0" xyz="0 0 0"/>
            
            <axis xyz="0 0 1" />
            <parent link="virtual_link_ugv2tether_3_1"/>
            <child link="mp_500_1/tether_end"/>
            <dynamics damping="0.01" friction="0.0"/>
        </joint>
        
            <link name="tether_2">
            <visual>
                <origin rpy="0 0 0" xyz="0 0 10.0"/>
                <geometry>
                    <cylinder length="20.0" radius="0.005"/>
                </geometry>
            </visual>
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>
        <gazebo reference="tether_2">
            <material>Gazebo/Black</material>
        </gazebo>
            <link name="virtual_link_uav2tether_1_2">
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>

        <link name="virtual_link_uav2tether_2_2">
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>
            <link name="virtual_link_ugv2tether_1_2">
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>

        <link name="virtual_link_ugv2tether_2_2">
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>

        <link name="virtual_link_ugv2tether_3_2">
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>
            <link name="rod_2">
            <visual>
                <origin rpy="0 0 0" xyz="0 0 0.1"/>
                <geometry>
                    <cylinder length="0.21" radius="0.01"/>
                </geometry>
            </visual>
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>
        <gazebo reference="rod_2">
            <material>Gazebo/Orange</material>
        </gazebo>
        <!--uav => tether joint-->
        <joint name="uav2rod_joint_2" type="fixed">
            <parent link="${namespace}/base_link"/>
            <child link="rod_2"/>
            
                <origin rpy="0 ${-pi/2} 0" xyz="0 0 0"/>
            
        </joint>

        <joint name="rod2tether_joint_roll_2" type="continuous">
            <origin rpy="0 0 0" xyz="0 0 0.21"/>
            <parent link="rod_2"/>
            <child link="virtual_link_uav2tether_1_2"/>
            <axis xyz="1 0 0" />
            <dynamics damping="0.01" friction="0.0"/>
        </joint>

        <joint name="rod2tether_joint_pitch_2" type="continuous">
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <parent link="virtual_link_uav2tether_1_2"/>
            <child link="virtual_link_uav2tether_2_2"/>
            <axis xyz="0 1 0" />
            <dynamics damping="0.01" friction="0.0"/>
        </joint>

        <joint name="rod2tether_joint_yaw_2" type="continuous">
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <parent link="virtual_link_uav2tether_2_2"/>
            <child link="tether_2"/>
            <axis xyz="0 0 1" />
            <dynamics damping="0.01" friction="0.0"/>
        </joint>
            <joint name="ugv2tether_joint_prismatic_2" type="prismatic">
            <origin rpy="0 0 0" xyz="0 0 5"/>
            <parent link="tether_2"/>
            <child link="virtual_link_ugv2tether_1_2"/>
            <axis xyz="0 0 -1" />
            <dynamics damping="0.01" friction="0.0"/>
            <limit effort="10000" lower="-5.0" upper="10.0" velocity="10.0"/>
        </joint>

        <joint name="ugv2tether_joint_roll_2" type="continuous">
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <parent link="virtual_link_ugv2tether_1_2"/>
            <child link="virtual_link_ugv2tether_2_2"/>
            <axis xyz="1 0 0" />
            <dynamics damping="0.01" friction="0.0"/>
        </joint>

        <joint name="ugv2tether_joint_pitch_2" type="continuous">
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <parent link="virtual_link_ugv2tether_2_2"/>
            <child link="virtual_link_ugv2tether_3_2"/>
            <axis xyz="0 1 0" />
            <dynamics damping="0.01" friction="0.0"/>
        </joint>

        <joint name="ugv2tether_joint_yaw_2" type="continuous">
            
                <origin rpy="0 ${pi/2} 0" xyz="0 0 0"/>
            
            <axis xyz="0 0 1" />
            <parent link="virtual_link_ugv2tether_3_2"/>
            <child link="mp_500_2/tether_end"/>
            <dynamics damping="0.01" friction="0.0"/>
        </joint>
        
            <link name="tether_3">
            <visual>
                <origin rpy="0 0 0" xyz="0 0 10.0"/>
                <geometry>
                    <cylinder length="20.0" radius="0.005"/>
                </geometry>
            </visual>
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>
        <gazebo reference="tether_3">
            <material>Gazebo/Black</material>
        </gazebo>
            <link name="virtual_link_uav2tether_1_3">
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>

        <link name="virtual_link_uav2tether_2_3">
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>
            <link name="virtual_link_ugv2tether_1_3">
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>

        <link name="virtual_link_ugv2tether_2_3">
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>

        <link name="virtual_link_ugv2tether_3_3">
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>
            <link name="rod_3">
            <visual>
                <origin rpy="0 0 0" xyz="0 0 0.1"/>
                <geometry>
                    <cylinder length="0.21" radius="0.01"/>
                </geometry>
            </visual>
            <inertial>
                <mass value="0.001"/>
                <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0.0" ixz="0.0" iyz="0.0"/>
            </inertial>
        </link>
        <gazebo reference="rod_3">
            <material>Gazebo/Orange</material>
        </gazebo>
        <!--uav => tether joint-->
        <joint name="uav2rod_joint_3" type="fixed">
            <parent link="${namespace}/base_link"/>
            <child link="rod_3"/>
            
                <origin rpy="${-pi/2} 0 0" xyz="0 0 0"/>
            
        </joint>

        <joint name="rod2tether_joint_roll_3" type="continuous">
            <origin rpy="0 0 0" xyz="0 0 0.21"/>
            <parent link="rod_3"/>
            <child link="virtual_link_uav2tether_1_3"/>
            <axis xyz="1 0 0" />
            <dynamics damping="0.01" friction="0.0"/>
        </joint>

        <joint name="rod2tether_joint_pitch_3" type="continuous">
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <parent link="virtual_link_uav2tether_1_3"/>
            <child link="virtual_link_uav2tether_2_3"/>
            <axis xyz="0 1 0" />
            <dynamics damping="0.01" friction="0.0"/>
        </joint>

        <joint name="rod2tether_joint_yaw_3" type="continuous">
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <parent link="virtual_link_uav2tether_2_3"/>
            <child link="tether_3"/>
            <axis xyz="0 0 1" />
            <dynamics damping="0.01" friction="0.0"/>
        </joint>
            <joint name="ugv2tether_joint_prismatic_3" type="prismatic">
            <origin rpy="0 0 0" xyz="0 0 5"/>
            <parent link="tether_3"/>
            <child link="virtual_link_ugv2tether_1_3"/>
            <axis xyz="0 0 -1" />
            <dynamics damping="0.01" friction="0.0"/>
            <limit effort="10000" lower="-5.0" upper="10.0" velocity="10.0"/>
        </joint>

        <joint name="ugv2tether_joint_roll_3" type="continuous">
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <parent link="virtual_link_ugv2tether_1_3"/>
            <child link="virtual_link_ugv2tether_2_3"/>
            <axis xyz="1 0 0" />
            <dynamics damping="0.01" friction="0.0"/>
        </joint>

        <joint name="ugv2tether_joint_pitch_3" type="continuous">
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <parent link="virtual_link_ugv2tether_2_3"/>
            <child link="virtual_link_ugv2tether_3_3"/>
            <axis xyz="0 1 0" />
            <dynamics damping="0.01" friction="0.0"/>
        </joint>

        <joint name="ugv2tether_joint_yaw_3" type="continuous">
            
                <origin rpy="${pi/2} 0 0" xyz="0 0 0"/>
            
            <axis xyz="0 0 1" />
            <parent link="virtual_link_ugv2tether_3_3"/>
            <child link="mp_500_3/tether_end"/>
            <dynamics damping="0.01" friction="0.0"/>
        </joint>
        <gazebo>
            <plugin name="gazebo_tensions_plugin" filename="libgazebo_tensions_plugin.so"/>
            <plugin name="joint_state_publisher" filename="libgazebo_ros_joint_state_publisher.so">
                <robotNamespace>pelican</robotNamespace>
                <jointName>
                rod2tether_joint_roll_0, rod2tether_joint_pitch_0, rod2tether_joint_yaw_0,
                rod2tether_joint_roll_1, rod2tether_joint_pitch_1, rod2tether_joint_yaw_1,
                rod2tether_joint_roll_2, rod2tether_joint_pitch_2, rod2tether_joint_yaw_2,
                rod2tether_joint_roll_3, rod2tether_joint_pitch_3, rod2tether_joint_yaw_3,
                ugv2tether_joint_prismatic_0,
                ugv2tether_joint_prismatic_1,
                ugv2tether_joint_prismatic_2,
                ugv2tether_joint_prismatic_3,
                ugv2tether_joint_roll_0, ugv2tether_joint_pitch_0, ugv2tether_joint_yaw_0,
                ugv2tether_joint_roll_1, ugv2tether_joint_pitch_1, ugv2tether_joint_yaw_1,
                ugv2tether_joint_roll_2, ugv2tether_joint_pitch_2, ugv2tether_joint_yaw_2,
                ugv2tether_joint_roll_3, ugv2tether_joint_pitch_3, ugv2tether_joint_yaw_3
                </jointName>
                <updateRate>1000</updateRate>
                <alwaysOn>true</alwaysOn>
            </plugin>
        </gazebo>
    </xacro:macro>
</robot>